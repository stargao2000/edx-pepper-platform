// Generated by CoffeeScript 1.6.3
(function() {
  var oldAjaxWithPrefix;

  window.YT = {
    PlayerState: {
      UNSTARTED: -1,
      ENDED: 0,
      PLAYING: 1,
      PAUSED: 2,
      BUFFERING: 3,
      CUED: 5
    }
  };

  window.STATUS = window.YT.PlayerState;

  oldAjaxWithPrefix = window.jQuery.ajaxWithPrefix;

  window.onTouchBasedDevice = function() {
    return navigator.userAgent.match(/iPhone|iPod|iPad/i);
  };

  jasmine.stubbedCaption = {
    end: [3120, 6270, 8490, 21620, 24920, 25750, 27900, 34380, 35550, 40250],
    start: [1180, 3120, 6270, 14910, 21620, 24920, 25750, 27900, 34380, 35550],
    text: ["MICHAEL CIMA: So let's do the first one here.", "Vacancies, where do they come from?", "Well, imagine a perfect crystal.", "Now we know at any temperature other than absolute zero there's enough", "energy going around that some atoms will have more energy", "than others, right?", "There's a distribution.", "If I plot energy here and number, these atoms in the crystal will have a", "distribution of energy.", "And some will have quite a bit of energy, just for a moment."]
  };

  window.jQuery.ajaxWithPrefix = function(url, settings) {
    var data, success;
    if (!settings) {
      settings = url;
      url = settings.url;
      success = settings.success;
      data = settings.data;
    }
    if (url.match(/Z5KLxerq05Y/g) !== null || url.match(/7tqY6eQzVhE/g) !== null || url.match(/cogebirgzzM/g) !== null) {
      if (window.jQuery.isFunction(success) === true) {
        return success(jasmine.stubbedCaption);
      } else if (window.jQuery.isFunction(data) === true) {
        return data(jasmine.stubbedCaption);
      }
    } else {
      return oldAjaxWithPrefix.apply(this, arguments);
    }
  };

  window.WAIT_TIMEOUT = 1000;

  jasmine.getFixtures().fixturesPath += 'fixtures';

  jasmine.stubbedMetadata = {
    '7tqY6eQzVhE': {
      id: '7tqY6eQzVhE',
      duration: 300
    },
    'cogebirgzzM': {
      id: 'cogebirgzzM',
      duration: 200
    },
    bogus: {
      duration: 100
    }
  };

  jasmine.fireEvent = function(el, eventName) {
    var event;
    if (document.createEvent) {
      event = document.createEvent("HTMLEvents");
      event.initEvent(eventName, true, true);
    } else {
      event = document.createEventObject();
      event.eventType = eventName;
    }
    event.eventName = eventName;
    if (document.createEvent) {
      return el.dispatchEvent(event);
    } else {
      return el.fireEvent("on" + event.eventType, event);
    }
  };

  jasmine.stubbedHtml5Speeds = ['0.75', '1.0', '1.25', '1.50'];

  jasmine.stubRequests = function() {
    return spyOn($, 'ajax').andCallFake(function(settings) {
      var match, status;
      if (match = settings.url.match(/youtube\.com\/.+\/videos\/(.+)\?v=2&alt=jsonc/)) {
        status = match[1].split('_');
        if (status && status[0] === 'status') {
          return {
            always: function(callback) {
              return callback.call(window, {}, status[1]);
            },
            error: function(callback) {
              return callback.call(window, {}, status[1]);
            },
            done: function(callback) {
              return callback.call(window, {}, status[1]);
            }
          };
        } else if (settings.success) {
          return settings.success({
            data: jasmine.stubbedMetadata[match[1]]
          });
        } else {
          return {
            always: function(callback) {
              return callback.call(window, {}, 'success');
            },
            done: function(callback) {
              return callback.call(window, {}, 'success');
            }
          };
        }
      } else if (match = settings.url.match(/static(\/.*)?\/subs\/(.+)\.srt\.sjson/)) {
        return settings.success(jasmine.stubbedCaption);
      } else if (settings.url.match(/.+\/problem_get$/)) {
        return settings.success({
          html: readFixtures('problem_content.html')
        });
      } else if (settings.url === '/calculate' || settings.url.match(/.+\/goto_position$/) || settings.url.match(/event$/) || settings.url.match(/.+\/problem_(check|reset|show|save)$/)) {

      } else {
        throw "External request attempted for " + settings.url + ", which is not defined.";
      }
    });
  };

  jasmine.stubYoutubePlayer = function() {
    return YT.Player = function() {
      var obj;
      obj = jasmine.createSpyObj('YT.Player', ['cueVideoById', 'getVideoEmbedCode', 'getCurrentTime', 'getPlayerState', 'getVolume', 'setVolume', 'loadVideoById', 'playVideo', 'pauseVideo', 'seekTo', 'getDuration', 'getAvailablePlaybackRates', 'setPlaybackRate']);
      obj['getAvailablePlaybackRates'] = jasmine.createSpy('getAvailablePlaybackRates').andReturn([0.75, 1.0, 1.25, 1.5]);
      return obj;
    };
  };

  jasmine.stubVideoPlayer = function(context, enableParts, html5) {
    var currentPartName, suite;
    if (html5 == null) {
      html5 = false;
    }
    suite = context.suite;
    while (suite = suite.parentSuite) {
      currentPartName = suite.description;
    }
    if (html5 === false) {
      loadFixtures('video.html');
    } else {
      loadFixtures('video_html5.html');
    }
    jasmine.stubRequests();
    YT.Player = void 0;
    window.OldVideoPlayer = void 0;
    jasmine.stubYoutubePlayer();
    return new Video('#example', '.75:7tqY6eQzVhE,1.0:cogebirgzzM');
  };

  $.cookie = jasmine.createSpy('jQuery.cookie').andReturn('1.0');

  $.fn.qtip = jasmine.createSpy('jQuery.qtip');

  $.fn.scrollTo = jasmine.createSpy('jQuery.scrollTo');

}).call(this);
